@sections.apiReference(
    "Rest API V2 Reference",
    "Our Rest API let's you build your own custom logic on top of your referral program. This API reference includes a guide to using all the methods of the Referral SaaSquatch Rest API."
) {
    <section>
        <div class="page-header">
            <h1>Rest V2 API Reference</h1>
        </div>

        <p class="lead">
            V2 is better.
        </p>

        @tags.apiSummaryTable()

        <h2>Lookup a single reward</h2>
        <a id="get_reward" name="get_reward" class="section-anchor">&nbsp;</a>

        <p>Looks up a single reward</p>
        <h4>Definition</h4>
        <pre class="prettyprint lang-curl">GET https://app.referralsaasquatch.com/api/v2/{TENANT_ALIAS}/reward</pre>

        <h4>Arguments</h4>
        <div>
            <table class="table table-hover">
               <tr>
                <th class="docs-monospace">accountId</th>
                <td><span class="label">Required</span></td>
                <td>
                    The ID of the account to look up.
                </td>
              </tr>

              <tr>
                <th class="docs-monospace">rewardTypeFilter</th>
                <td><span class="label">Optional</span></td>
                <td>
                    Filters rewards by type.
                </td>
              </tr>
              <tr>
                <th class="docs-monospace">featureTypeFilter</th>
                <td><span class="label">Optional</span></td>
                <td>
                    Filters rewards by feature type.
                </td>
              </tr>
              <tr>
                <th class="docs-monospace">userId</th>
                <td><span class="label">Optional</span></td>
                <td>
                    Filters rewards by user.
                </td>
              </tr>
            </table>
        </div>
    
        <h4>Returns</h4>
        <p>A list of RewardAggregateDto</p>
        <pre>
            public static abstract class RewardV2 {
        public String id;
        public RewardType type;
        public Date dateGiven;
        public Date dateExpires;
        public Date dateCancelled;
        public String accountId;
        public String userId;
        public boolean cancellable;
        public RewardSourceType rewardSource;
        public abstract<T> T acceptVisitor(RewardVisitor<T> visitor);
        public RewardV2(RewardType type) {
        	this.type = type;
        }
        public String asJson() {
        	return Json.toJson(this).toString();
        }
    }
    
    public static class DiscountRewardV2 extends RewardV2 {
    	public Integer discountPct;
    	DiscountRewardV2() {
    		super(RewardType.PCT_DISCOUNT);
    	}
		@Override
		public <T> T acceptVisitor(RewardVisitor<T> visitor) {
			return visitor.accept(this);
		}
    }
    
    public static class FeatureRewardV2 extends RewardV2 {
        public String featureType; // 1 DNS, 100MB Storage, etc...
        public String name;
        public String description;
        public int quantity;
        public String unit;
        FeatureRewardV2() {
        	super(RewardType.FEATURE);
        }
		@Override
		public <T> T acceptVisitor(RewardVisitor<T> visitor) {
			return visitor.accept(this);
		}
    }
    
    public static class CreditRewardV2 extends RewardV2 {
    	public String unit;
    	public Integer assignedCredit;
    	public Integer redeemedCredit;
    	CreditRewardV2() {
    		super(RewardType.CREDIT);
    	}
    	CreditRewardV2(RewardType rewardType) {
    		super(rewardType);
    	}
		@Override
		public <T> T acceptVisitor(RewardVisitor<T> visitor) {
			return visitor.accept(this);
		}
		public boolean isRedeemable() {
			return assignedCredit - redeemedCredit > 0;
		}
    }
    
    public static class TimeCreditRewardV2 extends CreditRewardV2 {
    	TimeCreditRewardV2() {
    		super(RewardType.TIME_CREDIT);
    	}
    	@Override
    	public <T> T acceptVisitor(RewardVisitor<T> visitor) {
    		return visitor.accept(this);
    	}
    }
        </pre>
        <table class="table table-hover">
            <tr>
                <th class="docs-monospace">id</th>
                <td>String</td>
                <td>
                    The unique identifier for this reward
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">type</th>
                <td>Enum</td>
                <td>
                    The type of reward. One of either <code>PCT_DISCOUNT</code>, <code>FEATURE</code>, <code>TIME_CREDIT</code> or <code>CREDIT</code>.
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">dateGiven</th>
                <td>Timestamp</td>
                <td>
                    When this reward was earned.
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">dateExpires</th>
                <td>Timestamp</td>
                <td>
                    When this reward is set to expire.
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">dateCancelled</th>
                <td>Timestamp</td>
                <td>
                    If the reward is <code>cancellable</code> and has been cnacelled, the date it was cancelled on. Null if not never cancelled.
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">rewardSource</th>
                <td>Enum</td>
                <td>
                    The type of the source of the reward. One of either <code>FRIEND_SIGNUP</code> or <code>REFERRED</code>.
                </td>
            </tr>
            
            <tr>
                <th class="docs-monospace"></th>
                <td></td>
                <td>
                    <h3>Rewards can have subtypes</h3>
                    <table class="table">
                        <tr>
                            <th>Reward Type</th>
                            <td>Additional object details</td>
                        </tr>
                        <tr>
                            <th class="docs-monospace">PCT_DISCOUNT</th>
                            <td>
                                <table class="table table-hover">
                                    <tr>
                                        <th class="docs-monospace">discountPct</th>
                                        <td>Integer</td>
                                        <td>
                                            The percent discount. e.g. <code>10</code> means 10%
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <th class="docs-monospace">FEATURE</th>
                            <td>
                                <table class="table table-hover">
                                    <tr>
                                        <th class="docs-monospace">featureType</th>
                                        <td>String</td>
                                        <td>
                                            A unique identifier for the type of feature. E.g. "freeSeats" or "freeMb".
                                        </td>
                                    </tr>
                                    <tr>
                                        <th class="docs-monospace">unit</th>
                                        <td>String</td>
                                        <td>
                                            The description of the unit of measure. e.g. "Seats" or "Megabytes". 
                                        </td>
                                    </tr>
                                    <tr>
                                        <th class="docs-monospace">name</th>
                                        <td>String</td>
                                        <td>
                                            The name of the feature. e.g. "Free Seats" or "Free Storage"
                                        </td>
                                    </tr>
                                    <tr>
                                        <th class="docs-monospace">description</th>
                                        <td>String</td>
                                        <td>
                                            The feature description. e.g. "Bonus user seats for your account" or "Extra megabytes of free storage"
                                        </td>
                                    </tr>

                                    <tr>
                                        <th class="docs-monospace">quantity</th>
                                        <td>Integer</td>
                                        <td>
                                            The earned quantity of the feature
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <th class="docs-monospace">CREDIT</th>
                            <td>
                                <table class="table table-hover">
                                    <tr>
                                        <th class="docs-monospace">unit</th>
                                        <td>String</td>
                                        <td>
                                            The description of the unit of measure. e.g. "Seats" or "Megabytes". 
                                        </td>
                                    </tr>
                                    <tr>
                                        <th class="docs-monospace">assignedCredit</th>
                                        <td>Integer</td>
                                        <td>
                                            The earned quantity of the feature
                                        </td>
                                    </tr>
                                    <tr>
                                        <th class="docs-monospace">redeemedCredit</th>
                                        <td>Integer</td>
                                        <td>
                                            The redeemed quantity of the feature
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <th class="docs-monospace">TIME_CREDIT</th>
                            <td>
                                <table class="table table-hover">
                                    <tr>
                                        <th class="docs-monospace">unit</th>
                                        <td>String</td>
                                        <td>
                                            The description of the unit of measure. e.g. "Seats" or "Megabytes". 
                                        </td>
                                    </tr>
                                    <tr>
                                        <th class="docs-monospace">assignedCredit</th>
                                        <td>Integer</td>
                                        <td>
                                            The earned quantity of the feature
                                        </td>
                                    </tr>
                                    <tr>
                                        <th class="docs-monospace">redeemedCredit</th>
                                        <td>Integer</td>
                                        <td>
                                            The redeemed quantity of the feature
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                    The type of the source of the reward. One of either <code>FRIEND_SIGNUP</code> or <code>REFERRED</code>.
                </td>
            </tr>
        </table>
            

        <h4>Example Request</h4>
<pre class="prettyprint lang-curl">$ curl https://app.referralsaasquatch.com/api/v2/{TENANT_ALIAS}/reward?accountId=1 \
-u API_KEY: \
-H "Content-Type: application/json"</pre>

        <hr />

    </section>
}
