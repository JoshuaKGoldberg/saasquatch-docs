{% extends '../api.html' %}

{% import "../tags/API.html" as API %}

{% block content %}

<section>
  <div class="page-header">
      <h1>{{title}}</h1>
  </div>
  
  {% if highlights %}
  <p class="lead">
    {{ highlights }}
  </p>
  {% endif %}

        {{ API.apiSummaryTable() }}

        <div class="apidocs-section">
        
        <h2>Update an account</h2>
        <a id="account_sync" name="account_sync" class="section-anchor">&nbsp;</a>

        <p>Use this method to update SaaSquatch when the status of an account changes or when a new account is created. 
            If you're using a payment system connector, such as the Recurly connector, then you won't need to use this method. We automatically track account status for Braintree, Stripe, Reculy and Zuora.</p>
        <h4>Definition</h4>
        <pre class="prettyprint lang-curl">POST https://app.referralsaasquatch.com/api/v1/{TENANT_ALIAS}/accountsync</pre>

        <h4>Arguments</h4>
        <div>
            <table class="table table-hover apidocs-args">
              <tr>
                <th class="docs-monospace">id</th>
                <td><span class="label">Required</span></td>
                <td>
                    The id of the account. This should be the same <code>account_id</code> used for <a href="/app-integration">squatch.js</a>. Not sure what to use here? See <a href="/shared-vs-solo-accounts">Shared vs. Solo accounts</a>
                </td>
              </tr>
              <tr>
                <th class="docs-monospace">subscription</th>
                <td><span class="label">Required</span></td>
                <td>
                    An object describing the current subscription for this account.<br><br>

                    <table class="table table-hover">
                          <tr>
                            <th class="docs-monospace">status</th>
                            <td>
                                The status of the subscription. One of <code>PAID</code>, <code>TRIAL</code>, <code>FREE</code> or <code>CANCELLED</code>, 
                            </td>
                          </tr>
                          <tr>
                            <th class="docs-monospace">billingIntervalType</th>
                            <td>
                                The unit type for <code>billingIntervalValue</code>. One of <code>DAY</code>, <code>WEEK</code>, <code>MONTH</code>,  <code>QUARTER</code>, <code>SEMI_ANNUAL</code> or <code>YEAR</code>.
                                Required when <code>status: PAID</code>.
                            </td>
                          </tr>
                          <tr>
                            <th class="docs-monospace">billingIntervalValue</th>
                            <td>
                                The number of <code>billingIntervalType</code>. Required when <code>status: PAID</code>.<br/>
                                
                                <table class="table">
                                    <caption>Example billing intervals</caption>
                                    <tr><td></td><td>billingIntervalValue</td><td>billingIntervalType</td></tr>
                                    <tr><td>Monthly billing</td><td>1</td><td>MONTH</td></tr>
                                    <tr><td>Yearly billing</td><td>1</td><td>YEAR</td></tr>
                                    <tr><td>4 Month billing</td><td>4</td><td>MONTH</td></tr>
                                </table>

                            </td>
                          </tr>
                          <tr>
                            <th class="docs-monospace">value</th>
                            <td>
                                Dollar value of the subscription per renewal. Required when <code>status: PAID</code>.
                            </td>
                          </tr>
                    </table>
                </td>
              </tr>
              <tr>
                <th class="docs-monospace">referral</th>
                <td><span class="label">Optional</span></td>
                <td>
                    Info about who referred this account. Use this on first signup.<br><br>
                    
                    <table class="table table-hover">
                          <tr>
                            <th class="docs-monospace">code</th>
                            <td>
                                The referral code of the person that referred this account. Use <a href="/squatchjs#autofill">squatch.js autofill</a> to retrieve this value from the tracking cookie on your checkout form.
                            </td>
                          </tr>
                    </table>
                </td>
              </tr>
              <tr>
                <th class="docs-monospace">currency</th>
                <td><span class="label">Optional</span></td>
                <td>
                    Default is "USD". Otherwise use a ISO 4217 Standard currency code in uppercase.
                </td>
              </tr>
              </table>
        </div>
    
        <h4>Returns</h4>
        <p>The current status of the account, mirroring the input, or an HTTP Error code on error.</p>

{% set req = '
$ curl https://app.referralsaasquatch.com/api/v1/{TENANT_ALIAS}/accountsync \ <br>
-u API_KEY: \ <br>
-H "Content-Type: application/json" \ <br>
-d "{ <br>
    "id": "a1234", <br>
    "currency": "USD", <br>
    "subscription": { <br>
        "status": "PAID", <br>
        "value": 99.99, <br>
        "billingIntervalType": "DAY", <br>
        "billingIntervalValue": 30 <br>
    }, <br>
    "referral": { <br>
        "code": "3j033r" <br>
    } <br>
}" <br>
' %}
{% set res = '
{ <br>
    "id": "a1234", <br>
    "currency": "USD", <br>
    "subscription": { <br>
        "status": "PAID", <br>
        "value": 99.99, <br>
        "billingIntervalType": "DAY", <br>
        "billingIntervalValue": 30 <br>
    }, <br>
    "referral": { <br>
        "code": "3j033r" <br>
    } <br>
} <br>
' %}
{{ API.exampleCurl("account_sync", req, res) }}


    </div><!-- // .apidocs-section -->























      <div class="apidocs-section">

        <h2>Lookup a referral code</h2>
        <a id="get_code" name="get_code" class="section-anchor">&nbsp;</a>

        <p>Looks up a referral code and the attached details. Works with: {{ API.discount() }} {{ API.feature() }} {{ API.freeTime() }} {{ API.credit() }}</p>
        <h4>Definition</h4>
        <pre class="prettyprint lang-curl">GET https://app.referralsaasquatch.com/api/v1/{TENANT_ALIAS}/code/{CODE}</pre>

        <h4>Arguments</h4>
        <div>
            <table class="table table-hover apidocs-args">
               <tr>
                <th class="docs-monospace">code</th>
                <td><span class="label">Required</span></td>

                <td>
                    The referral code to look up. E.g. "BOBTESTERSON"
                </td>
              </tr>
            </table>
        </div>
        
        <h4>Returns</h4>
        <p>Details of the referral code</p>

        <table class="table table-hover apidocs-args">
            <tr>
                <th class="docs-monospace">code</th>
                <td>String</td>
                <td>
                    The unique identifier for the code. E.g. "BOBTESTERSON"
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">dateCreated</th>
                <td>Timestamp</td>
                <td>
                    The date the code was created.
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">referrerName</th>
                <td>String</td>
                <td>
                    The name of the owner of this code. E.g. "Bob Testerson"
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">reward</th>
                <td>Object</td>
                <td>
                    Details of the reward attached to this code
                    
                    <table class="table table-hover apidocs-args">
                        <tr>
                            <th class="docs-monospace">type</th>
                            <td>String</td>
                            <td>
                                The unique identifier for the code. E.g. "BOBTESTERSON"
                            </td>
                        </tr>
                        <tr>
                            <th class="docs-monospace">unit</th>
                            <td>String</td>
                            <td>
                                A unique identifier for the type of reward. E.g. "cents" or "freemonth"
                            </td>
                            <td>
                                 Works with: {{ API.feature() }} {{ API.freeTime() }} {{ API.credit() }}
                            </td>
                        </tr>
                        <tr>
                            <th class="docs-monospace">discountPercent</th>
                            <td>Integer</td>
                            <td>
                                The percent discount that the referral code is valid for. E.g. "10"
                            </td>
                            <td>
                                Works with: {{ API.discount() }}
                            </td>
                        </tr>
                        <tr>
                            <th class="docs-monospace">monthsDiscountIsValid</th>
                            <td>Integer</td>
                            <td>
                                The duration that the discount is valid for. E.g. "12" months
                            </td>
                            <td>
                                Works with: {{ API.discount() }}
                            </td>
                        </tr>
                        <tr>
                            <th class="docs-monospace">credit</th>
                            <td>Integer</td>
                            <td>
                                The amount of credit that this referral code is valid for. e.g. for $20 this object would have <code>credit=2000, unit="cents"</code>
                            </td>
                            <td>
                                Works with: {{ API.freeTime() }} {{ API.credit() }}
                            </td>
                        </tr>
                        <tr>
                            <th class="docs-monospace">featureType</th>
                            <td>String</td>
                            <td>
                                A unique identifier for the type of feature
                            </td>
                            <td>
                                Works with: {{ API.feature() }}
                            </td>
                        </tr>
                        <tr>
                            <th class="docs-monospace">name</th>
                            <td>String</td>
                            <td>
                                The human readable name of the feature
                            </td>
                            <td>
                                Works with: {{ API.feature() }}
                            </td>
                        </tr>
                        <tr>
                            <th class="docs-monospace">description</th>
                            <td>String</td>
                            <td>
                                The human readable description of the feature
                            </td>
                            <td>
                                Works with: {{ API.feature() }}
                            </td>
                        </tr>
                        <tr>
                            <th class="docs-monospace">quantity</th>
                            <td>Integer</td>
                            <td>
                                The quantity of feature that this referral code is valid for. E.g. For 500mb fre space <code>quantity=500, unit="mb"</code>
                            </td>
                            <td>
                                Works with: {{ API.feature() }}
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>

{% set req = '
$ curl https://app.referralsaasquatch.com/api/v1/{TENANT_ALIAS}/code/BOBTESTERSON \ <br>
-u API_KEY: \ <br>
-H "Content-Type: application/json" <br>
' %}
{% set res = '
// Example 1 <br>
{ <br>
	"code": "BOBTESTERSON", <br>
	"dateCreated": 1411600868797, <br>
	"referrerName": "Bob Testerson", <br>
	"reward": { <br>
		"type": "PCT_DISCOUNT", <br>
		"discountPercent": 10, <br>
		"monthsDiscountIsValid": 12 <br>
	} <br>
} <br>
 <br>
 <br>
// Example 2 <br>
{ <br>
	"code": "BOBTESTERSON", <br>
	"dateCreated": 1411600868797, <br>
	"referrerName": "Bob Testerson", <br>
	"reward": { <br>
		"type": "CREDIT", <br>
		"unit": "cents", <br>
		"credit": 2000 <br>
	} <br>
} <br>
 <br>
 <br>
// Example 3 <br>
{ <br>
	"code": "BOBTESTERSON", <br>
	"dateCreated": 1411600868797, <br>
	"referrerName": "Bob Testerson", <br>
	"reward": { <br>
		"type": "FEATURE", <br>
		"featureType": "storage", <br>
		"name": "100 MB Storage", <br>
		"description": "100 MB Free Storage", <br>
		"quantity": 100, <br>
		"unit": "MB" <br>
	} <br>
} <br>
' %}
{{ API.exampleCurl("get_code", req, res) }}


    </div><!-- // .apidocs-section -->












        <div class="apidocs-section">

        <h2>List Reward Balances</h2>
        <a id="list_balances" name="list_balances" class="section-anchor">&nbsp;</a>

        <p>Looks up the balance for all rewards of the same type and units. Works with: {{ API.discount() }} {{ API.feature() }} {{ API.freeTime() }} {{ API.credit() }}</p>
        <h4>Definition</h4>
        <pre class="prettyprint lang-curl">GET https://app.referralsaasquatch.com/api/v1/{TENANT_ALIAS}/reward/balance</pre>

        <h4>Arguments</h4>
        <div>
            <table class="table table-hover apidocs-args">
               <tr>
                <th class="docs-monospace">accountId</th>
                <td><span class="label">Required</span></td>

                <td>
                    The ID of the account to look up.
                </td>
              </tr>

              <tr>
                <th class="docs-monospace">rewardTypeFilter</th>
                <td><span class="label">Optional</span></td>
                <td>
                    Filters rewards by type.
                </td>
              </tr>
              <tr>
                <th class="docs-monospace">userId</th>
                <td><span class="label">Optional</span></td>
                <td>
                    Filters rewards by user.
                </td>
              </tr>
              <tr>
                <th class="docs-monospace">featureTypeFilter</th>
                <td><span class="label">Optional</span></td>
                <td>
                    Filters rewards by feature type.
                </td>
                <td>
                     Works with: {{ API.feature() }}
                </td>
              </tr>
            </table>
        </div>
        
        
        <h4>Returns</h4>
        <p>A list of reward balances</p>

        <table class="table table-hover apidocs-args">
            <tr>
                <th class="docs-monospace">type</th>
                <td>Enum</td>
                <td>
                    The type of reward. One of either the following:
                    <table class="table">
                        <tr>
                            <td>{{ API.discount() }}</td>
                            <td><code>PCT_DISCOUNT</code></td>
                        </tr>
                        <tr>
                            <td>{{ API.feature() }}</td>
                            <td><code>FEATURE</code></td>
                        </tr>
                        <tr>
                            <td>{{ API.freeTime() }}</td>
                            <td><code>TIME_CREDIT</code></td>
                        </tr>
                        <tr>
                            <td>{{ API.credit() }}</td>
                            <td><code>CREDIT</code></td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">unit</th>
                <td>String</td>
                <td>
                    An identifier for the unit of the reward. E.g. "credit-in-cents", "freemb", "giftcard20", "tshirt", "freemonth"
                </td>
                <td>
                    Works with: <br/>
                    {{ API.feature() }}
                    {{ API.freeTime() }}
                    {{ API.credit() }}
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">count</th>
                <td>Integer</td>
                <td>
                    The number of rewards earned. Usually is equal to the number of successful referrals made. E.g. An account has $80 of credit due to the referral program. $60 from making referrals, $20 from being referred. The <code>count</code> would be <strong>4</strong> rewards, each worth $20.
                </td>
                <td>
                    Works with: <br/>
                    {{ API.feature() }}
                    {{ API.freeTime() }}
                    {{ API.credit() }}
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">totalQuantity</th>
                <td>Integer</td>
                <td>
                    The total <code>quantity</code> for all features of the same <code>featureType</code>.
                </td>
                <td>
                    Works with: <br/>
                    {{ API.feature() }}
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">featureType</th>
                <td>String</td>
                <td>
                    A unique identifier for the type of feature. E.g. "freeSeats" or "freeMb".
                </td>
                <td>
                    Works with: <br/>  {{ API.feature() }}
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">totalAssignedCredit</th>
                <td>Integer</td>
                <td>
                    The total <code>assignedCredit</code> for all reward credits of the same <code>unit</code> type.
                </td>
                <td>
                    Works with: <br/>
                    {{ API.credit() }}
                    {{ API.freeTime() }}
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">totalRedeemedCredit</th>
                <td>Integer</td>
                <td>
                    The total <code>redeemedCredit</code> for all reward credits of the same <code>unit</code> type.
                </td>
                <td>
                    Works with: <br/>
                    {{ API.credit() }}
                    {{ API.freeTime() }}
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">totalDiscountPercent</th>
                <td>Integer</td>
                <td>
                    The total <code>discountPercent</code> from all rewards
                </td>
                <td>
                    Works with: <br/> {{ API.discount() }}
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">referredDiscountPercent</th>
                <td>Integer</td>
                <td>
                    The total <code>discountPercent</code> from rewards with <code>rewardSource = REFERRED</code>
                </td>
                <td>
                    Works with: <br/> {{ API.discount() }}
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">referrerDiscountPercent</th>
                <td>Integer</td>
                <td>
                    The total <code>discountPercent</code> from rewards with <code>rewardSource = FRIEND_SIGNUP</code>
                </td>
                <td>
                    Works with: <br/> {{ API.discount() }}
                </td>
            </tr>            
                
            </table>

{% set req = '
$ curl https://app.referralsaasquatch.com/api/v1/{TENANT_ALIAS}/reward/balance?accountId=XYZ[&userId=123][&rewardTypeFilter=FEATURE|CREDIT|PCT_DISCOUNT][&featureTypeFilter=megaAddon] \ <br>
-u API_KEY: \ <br>
-H "Content-Type: application/json" <br>
' %}
{% set res = '
[ <br>
    { <br>
    	"type": "FEATURE", <br>
    	"featureType": "storage", <br>
    	"count": 8, <br>
    	"totalQuantity": 500, <br>
    	"unit": "MB" <br>
    },<br>
    { <br>
    	"type": "CREDIT", <br>
    	"count": 4, <br>
    	"totalAssignedCredit": 10000, <br>
    	"totalRedeemedCredit" : 0, <br>
    	"unit": "cents" <br>
    }, <br>
    { <br>
    	"type": "PCT_DISCOUNT", <br>
    	"totalDiscountPercent": 30, <br>
    	"referredDiscountPercent": 10, <br>
    	"referrerDiscountPercent": 20 <br>
    } <br>
]
' %}
{{ API.exampleCurl("list_balances", req, res) }}

    </div><!-- // .apidocs-section -->






















        <div class="apidocs-section">

        <h2>Debit a reward balance</h2>
        <a id="debit_balance" name="debit_balance" class="section-anchor">&nbsp;</a>

        <p>Used to redeem the credit earned from a referral program. Permanently debits an account balance. Works with: {{ API.freeTime() }} {{ API.credit() }}</p>
        
        <h4>Definition</h4>
        <pre class="prettyprint lang-curl">POST https://app.referralsaasquatch.com/api/v1/{TENANT_ALIAS}/credit/bulkredeem</pre>

        <h4>Arguments</h4>
        <div>
            <table class="table table-hover apidocs-args">
               <tr>
                <th class="docs-monospace">accountId</th>
                <td><span class="label">Required</span></td>

                <td>
                    The ID of the account to be debitted.
                </td>
              </tr>
              <tr>
                <th class="docs-monospace">unit</th>
                <td><span class="label">Required</span></td>
                <td>
                    The type of credit to be debitted. E.g. "free-months" or "cents"
                </td>
              </tr>
              <tr>
                <th class="docs-monospace">amount</th>
                <td><span class="label">Required</span></td>
                <td>
                    The amount of credit to be debitted.
                </td>
              </tr>
            </table>
        </div>
        
        
        <h4>Returns</h4>
        <p>Details about the successful transaction. If there is not enough credit to perform this transaction, then an error will be returned instead.</p>

        <table class="table table-hover apidocs-args">
            <tr>
                <th class="docs-monospace">creditRedeemed</th>
                <td>Integer</td>
                <td>
                    The amount of credit that was just debitted. 
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">unit</th>
                <td>String</td>
                <td>
                    The type of credit that was just debitted.
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">creditAvailable</th>
                <td>Integer</td>
                <td>
                    The remaining credit in this account of the same <code>unit</code> type.
                </td>
            </tr>
        </table>
        

{% set req = '
$ curl https://app.referralsaasquatch.com/api/v1/TENANT_ALIAS/credit/bulkredeem \ <br>
-u API_KEY: \ <br>
-H "Content-Type: application/json" \ <br>
-d "{ <br>
	"accountId" : "XYZ", <br>
	"amount" : 200, <br>
	"unit" : "cents" <br>
}"
' %}
{% set res = '
{ <br>
	"creditRedeemed": 200, <br>
	"creditAvailable": 0, <br>
	"unit": "cents" <br>
}
' %}
{{ API.exampleCurl("debit_balance", req, res) }}

    </div><!-- // .apidocs-section -->














        <div class="apidocs-section">
        
        <h2>List an account's rewards</h2>
        <a id="list_rewards" name="list_rewards" class="section-anchor">&nbsp;</a>

        <p>Looks up a single reward. Works with: {{ API.discount() }} {{ API.feature() }} {{ API.freeTime() }} {{ API.credit() }}</p>
        <h4>Definition</h4>
        <pre class="prettyprint lang-curl">GET https://app.referralsaasquatch.com/api/v1/{TENANT_ALIAS}/reward</pre>

        <h4>Arguments</h4>
        <div>
            <table class="table table-hover apidocs-args">
               <tr>
                <th class="docs-monospace">accountId</th>
                <td><span class="label">Required</span></td>

                <td>
                    The ID of the account to look up.
                </td>
              </tr>

              <tr>
                <th class="docs-monospace">rewardTypeFilter</th>
                <td><span class="label">Optional</span></td>
                <td>
                    Filters rewards by type.
                </td>
              </tr>
              <tr>
                <th class="docs-monospace">userId</th>
                <td><span class="label">Optional</span></td>
                <td>
                    Filters rewards by user.
                </td>
              </tr>
              <tr>
                <th class="docs-monospace">featureTypeFilter</th>
                <td><span class="label">Optional</span></td>
                <td>
                    Filters rewards by feature type.
                </td>
                <td>
                     Works with: {{ API.feature() }}
                </td>
              </tr>
            </table>
        </div>
    
        <h4>Returns</h4>
        <p>A list of rewards</p>

        <table class="table table-hover apidocs-args">
            <tr>
                <th class="docs-monospace">id</th>
                <td>String</td>
                <td>
                    The unique identifier for this reward
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">type</th>
                <td>Enum</td>
                <td>
                    The type of reward. One of either the following:
                    <table class="table">
                        <tr>
                            <td>{{ API.discount() }}</td>
                            <td><code>PCT_DISCOUNT</code></td>
                        </tr>
                        <tr>
                            <td>{{ API.feature() }}</td>
                            <td><code>FEATURE</code></td>
                        </tr>
                        <tr>
                            <td>{{ API.freeTime() }}</td>
                            <td><code>TIME_CREDIT</code></td>
                        </tr>
                        <tr>
                            <td>{{ API.credit() }}</td>
                            <td><code>CREDIT</code></td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">dateGiven</th>
                <td>Timestamp</td>
                <td>
                    When this reward was earned.
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">dateExpires</th>
                <td>Timestamp</td>
                <td>
                    When this reward is set to expire.
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">dateCancelled</th>
                <td>Timestamp</td>
                <td>
                    If the reward is <code>cancellable</code> and has been cnacelled, the date it was cancelled on. Null if not never cancelled.
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">cancellable</th>
                <td>Boolean</td>
                <td>
                    If a reward is <code>cancellable</code> then it may be revoked. If it has been cancelled then <code>dateCancelled</code> will be non-null.
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">rewardSource</th>
                <td>Enum</td>
                <td>
                    The type of the source of the reward. One of either <code>FRIEND_SIGNUP</code> or <code>REFERRED</code>.
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">unit</th>
                <td>String</td>
                <td>
                    An identifier for the unit of the reward. E.g. "credit-in-cents", "freemb", "giftcard20", "tshirt", "freemonth"
                </td>
                <td>
                    Works with: <br/>
                    {{ API.feature() }}
                    {{ API.freeTime() }}
                    {{ API.credit() }}
                </td>
            </tr>
            
            <tr>
                <th class="docs-monospace">discountPercent</th>
                <td>Integer</td>
                <td>
                    The percent discount. E.g. <code>10</code> means 10%
                </td>
                <td>
                    Works with: <br/> {{ API.discount() }}
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">featureType</th>
                <td>String</td>
                <td>
                    A unique identifier for the type of feature. E.g. "freeSeats" or "freeMb".
                </td>
                <td>
                    Works with: <br/>  {{ API.feature() }}
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">name</th>
                <td>String</td>
                <td>
                    The name of the feature. e.g. "Free Seats" or "Free Storage"
                </td>
                <td>
                    Works with: <br/> {{ API.feature() }}
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">description</th>
                <td>String</td>
                <td>
                    The feature description. e.g. "Bonus user seats for your account" or "Extra megabytes of free storage"
                </td>
                <td>
                    Works with: <br/> {{ API.feature() }}
                </td>
            </tr>

            <tr>
                <th class="docs-monospace">quantity</th>
                <td>Integer</td>
                <td>
                    The earned quantity of the feature
                </td>
                <td>
                    Works with: <br/> {{ API.feature() }}
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">assignedCredit</th>
                <td>Integer</td>
                <td>
                    The earned quantity of the feature
                </td>
                <td>
                    Works with: <br/> {{ API.freeTime() }} {{ API.credit() }}
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">redeemedCredit</th>
                <td>Integer</td>
                <td>
                    The redeemed quantity of the feature
                </td>
                <td>
                    Works with: <br/> {{ API.freeTime() }} {{ API.credit() }}
                </td>
            </tr>
        </table>

{% set req = '
$ curl https://app.referralsaasquatch.com/api/v1/TENANT_ALIAS/coupon?accountId=XYZ[&userId=123][&rewardTypeFilter=FEATURE|CREDIT|PCT_DISCOUNT][&featureTypeFilter=megaAddon] \ <br>
-u API_KEY: \ <br>
-H "Content-Type: application/json" <br>
' %}
{% set res = '
[{ <br>
    "type": "FEATURE", <br>
    "id": "5423508fe4b05184a716a08b", <br>
    "dateGiven": 1411600527094, <br>
    "dateExpires": null, <br>
    "dateCancelled": null, <br>
    "accountId": "F3BNA0HOKJR17656", <br>
    "userId": "5423508ee4b059bbbadf48e1", <br>
    "cancellable": false, <br>
    "rewardSource": "REFERRED", <br>
    "featureType": "storage", <br>
    "name": "100 MB Storage", <br>
    "description": "100 MB Free Storage", <br>
    "quantity": 100, <br>
    "unit": "MB" <br>
}, <br>
{ <br>
    "type": "PCT_DISCOUNT", <br>
    "id": "54235160e4b05184a716a0b2", <br>
    "dateGiven": 1411600736220, <br>
    "dateExpires": 1443136736220, <br>
    "dateCancelled": null, <br>
    "accountId": "GUYRP0T2F6F3Y6PN", <br>
    "userId": "54235132e4b059bbbadf4903", <br>
    "cancellable": true, <br>
    "rewardSource": "FRIEND_SIGNUP", <br>
    "discountPercent": 10 <br>
}, <br>
{ <br>
    "type": "CREDIT", <br>
    "id": "542351e4e4b05184a716a0c5", <br>
    "dateGiven": 1411600868797, <br>
    "dateExpires": null, <br>
    "dateCancelled": null, <br>
    "accountId": "85W7A2F1QZS9NGI8", <br>
    "userId": "542351e4e4b059bbbadf496d", <br>
    "cancellable": false, <br>
    "rewardSource": "FRIEND_SIGNUP", <br>
    "unit": "cents", <br>
    "assignedCredit": 10000, <br>
    "redeemedCredit": 0, <br>
    "redeemable": true <br>
}]
' %}
{{ API.exampleCurl("list_rewards", req, res) }}


    </div><!-- // .apidocs-section -->

        
        
        
        
        
        
        
        
        
        
        
        
        
        

        <div class="apidocs-section">

        <h2>Redeem a single reward</h2>
        <a id="debit_reward" name="debit_reward" class="section-anchor">&nbsp;</a>

        <p>Used to redeem an individual credit earned from a referral program. Works with: {{ API.freeTime() }} {{ API.credit() }}</p>
        
        <h4>Definition</h4>
        <pre class="prettyprint lang-curl">POST https://app.referralsaasquatch.com/api/v1/{TENANT_ALIAS}/credit/{ID}/redeem</pre>

        <h4>Arguments</h4>
        <div>
            <table class="table table-hover apidocs-args">
               <tr>
                <th class="docs-monospace">id</th>
                <td><span class="label">Required</span></td>

                <td>
                    The ID of the specific reward to be redeemed.
                </td>
              </tr>
              <tr>
                <th class="docs-monospace">unit</th>
                <td><span class="label">Required</span></td>
                <td>
                    The type of credit to be debitted. E.g. "free-months" or "cents"
                </td>
              </tr>
              <tr>
                <th class="docs-monospace">amount</th>
                <td><span class="label">Required</span></td>
                <td>
                    The amount of credit to be debitted.
                </td>
              </tr>
            </table>
        </div>
        
        
        <h4>Returns</h4>
        <p>Details about the successful transaction. If there is not enough credit to perform this transaction, then an error will be returned instead.</p>

        <table class="table table-hover apidocs-args">
            <tr>
                <th class="docs-monospace">creditRedeemed</th>
                <td>Integer</td>
                <td>
                    The amount of credit that was just debitted.
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">unit</th>
                <td>String</td>
                <td>
                    The type of credit that was just debitted.
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">creditAvailable</th>
                <td>Integer</td>
                <td>
                    The remaining credit in this account of the same <code>unit</code> type.
                </td>
            </tr>
        </table>
        

{% set req = '
$ curl https://app.referralsaasquatch.com/api/v1/TENANT_ALIAS/reward/{ID}/redeem \ <br>
-u API_KEY: \ <br>
-H "Content-Type: application/json" \ <br>
-d "{ <br>
	"amount": 1000, <br>
	"unit": "cents" <br>
}" <br>
' %}
{% set res = '
{ <br>
	"creditRedeemed": 1000, <br>
	"creditAvailable": 0, <br>
	"unit": "cents" <br>
}
' %}
{{ API.exampleCurl("debit_reward", req, res) }}


    </div><!-- // .apidocs-section -->





        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <div class="apidocs-section">
         
        <h2>Set discount code on an account</h2>
        <a id="set_coupon" name="set_coupon" class="section-anchor">&nbsp;</a>

        <p>This method associates a new account with their referrer. Use this method when someone signs up for a paid account to set the coupon code used for them.  For Stripe and Recurly do not use this call. Instead
            during sign-up, just pass the coupon/referral code in your subcribe call. Works with: {{ API.discount() }}
        </p>
        <h4>Definition</h4>
        <pre class="prettyprint lang-curl">POST https://app.referralsaasquatch.com/api/v1/{TENANT_ALIAS}/coupon</pre>

        <h4>Arguments</h4>
        <div>
            <table class="table table-hover apidocs-args">
              <tr>
                <th class="docs-monospace">couponCode</th>
                <td><span class="label">Required</span></td>
                <td>
                    The coupon/referral code of the user that referred this user. Can be obtained from the referral-tracking cookie using <a href="#autofill">squatch.js coupon autofill</a>.
                </td>
              </tr>
              <tr>
                <th class="docs-monospace">accountId</th>
                <td><span class="label">Required</span></td>
                <td>
                    We use this ID to link a group of users together. See <a href="/shared-vs-solo-accounts">Shared vs Solo Accounts</a> to see what you should use here.
                </td>
              </tr>
              <tr>
                <th class="docs-monospace">paymentProviderId</th>
                <td><span class="label">Required</span></td>
                <td>
                    The payment provider ID of the newly created account from Braintree or Zuora. This will be the Braintree Account ID or the Zuora Account ID of the newly created account.
                </td>
              </tr>
            </table>
        </div>
    
        <h4>Returns</h4>
        <p>HTTP Status with an Empty Response Body</p>
        <table class="table table-hover apidocs-args">
            <tr>
            <th>Braintree</th>
            <td>
                HTTP 201 on success
            </td>
            <td>
                Sets the value of the <code>saasquatch_coupon</code> custom field in Braintree and triggers an update to the referrer's account.
            </td>
            </tr>
            <tr>
            <th>Zuora</th>
            <td>
                HTTP 201 on success
            </td>
            <td>
                Sets the value of the <code>saasquatchCoupon</code> custom field in Zuora and triggers an update to the referrer's account.
            </td>
            </tr>
            <tr>
            <th>Recurly</th>
            <td>
                HTTP 400 not implemented
            </td>
            <td>
                Pass the coupon code to <a href="http://docs.recurly.com/api/subscriptions#create-subscription">Recurly Create Subscription</a> instead.
            </td>
            </tr>
            <tr>
            <th>Stripe</th>
            <td>
                HTTP 400 not implemented
            </td>
            <td>
                 Pass the coupon code to <a href="https://stripe.com/docs/api#create_customer">Stripe Create Customer</a> instead.
            </td>
            </tr>
            <tr>
            <th>Generic / API</th>
            <td>
                HTTP 400 not implemented
            </td>
            <td>
                Pass the coupon code to the <a href="/api/methods#account_sync">account sync</a> API endpoint instead.
            </td>
            </tr>
        </table>
            
{% set req = '
$ curl https://app.referralsaasquatch.com/api/v1/TENANT_ALIAS/coupon \ <br>
-u API_KEY: \ <br>
-H "Content-Type: application/json" \ <br>
-d " <br>
{ <br>
    "couponCode" : "BOBTESTERSON", <br>
    "accountId" : "abc", <br>
    "paymentProviderId" : "cus_123" <br>
}" <br>
' %}
{% set res = '
HTTP 201 Success (No response body)
' %}
{{ API.exampleCurl("set_coupon", req, res) }}



    </div><!-- // .apidocs-section -->

        
        
        
        
        
        
        
        
        
        
        
        
        
        <div class="apidocs-section">
         
        <h2>Lookup a discount code</h2>
        <a id="get_coupon" name="get_coupon" class="section-anchor">&nbsp;</a>

        <p>This method lets you look up the details of a referral code and to ensure that it is valid.  Works with: {{ API.discount() }}</p>
        <h4>Definition</h4>
        <pre class="prettyprint lang-curl">GET https://app.referralsaasquatch.com/api/v1/{TENANT_ALIAS}/coupon/{CODE}</pre>

        <h4>Arguments</h4>
        <div>
            <table class="table table-hover apidocs-args">
              <tr>
                <th class="docs-monospace">code</th>
                <td><span class="label">Required</span></td>
                <td>
                    The coupon/referral code to look up
                </td>
              </tr>
            </table>
        </div>
    
        <h4>Returns</h4>
        <p>Information about the coupon, or an HTTP 404 if the coupon code is not found.</p>
        <table class="table table-hover apidocs-args">
            <tr>
                <th class="docs-monospace">couponCode</th>
                <td>String</td>
                <td>
                    The coupon/referral code
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">discountPercentage</th>
                <td>Number</td>
                <td>
                    An integer representing the discount percentage. e.g. For 10% would return the number 10.
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">dateCreated</th>
                <td>Timestamp</td>
                <td>
                    The coupon/referral code to look up
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">ratePlanId</th>
                <td>String</td>
                <td>
                    <span class="label">Zuora only</span>
                    The Zuora rate plan ID used to apply this coupon.
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">discountId</th>
                <td>String</td>
                <td>
                    <span class="label">Braintree only</span>
                    The Braintree discount ID used to apply this coupon.
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">referrerName</th>
                <td>String</td>
                <td>
                    The full name of the referrer who owns this code.
                </td>
            </tr>
        </table>
        
{% set req = '
$ curl https://app.referralsaasquatch.com/api/v1/{TENANT_ALIAS}/coupon/JOHNDOE \ <br>
-u API_KEY: \ <br>
-H "Content-Type: application/json" <br>
' %}
{% set res = '
{ <br>
    "couponCode" : "JOHNDOE", <br>
    "discountPercentage" : 20, <br>
    "dateCreated" : 1377727546528, <br>
    "discountId" : "saasquatch_discount" <br>
}
' %}
{{ API.exampleCurl("get_coupon", req, res) }}


    </div><!-- // .apidocs-section -->
        
        
        
        
        
        <div class="apidocs-section">
        
        <h2>Lookup an account's discount</h2>
        <a id="get_account_reward" name="get_account_reward" class="section-anchor">&nbsp;</a>

        <p>This method associates a new account with their referrer. Use this method when someone signs up for a paid account to set the coupon code used for them.  Works with: {{ API.discount() }}</p>
        <h4>Definition</h4>
        <pre class="prettyprint lang-curl">GET https://app.referralsaasquatch.com/api/v1/{TENANT_ALIAS}/account/{ACCOUNT_ID}/reward</pre>

        <h4>Arguments</h4>
        <div>
            <table class="table table-hover apidocs-args">
              <tr>
                <th class="docs-monospace">accountId</th>
                <td><span class="label">Required</span></td>
                <td>
                    The account to look up
                </td>
              </tr>
              <tr>
                <th class="docs-monospace">couponCode</th>
                <td><span class="label">Optional</span></td>
                <td>
                    When included, will return a total reward available including any coupon code.
                </td>
              </tr>
              </table>
        </div>
    
        <h4>Returns</h4>
        <p>Information about the account's reward, if any, or an HTTP 404 if the account doesn't exist in SaaSquatch yet.</p>
        <table class="table table-hover apidocs-args">
            <tr>
                <th class="docs-monospace">accountId</th>
                <td>String</td>
                <td>
                    The account id
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">discountPercentage</th>
                <td>Number</td>
                <td>
                    An integer representing the total discount percentage from the referral program. e.g. For 10% would return the number 10. <code>discountPercentage = referredDiscountPercent + referrerDiscountPercent</code>
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">referredDiscountPercent</th>
                <td>Number</td>
                <td>
                    An integer representing the discount percentage from being referred. This will only have a value if the account has a coupon/referral code 
                    already associated with it, or if <code>couponCode</code> was passed as an argument.
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">referrerDiscountPercent</th>
                <td>Number</td>
                <td>
                    An integer representing the discount earned from referring other accounts.
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">ratePlanId</th>
                <td>String</td>
                <td>
                    <span class="label">Zuora only</span>
                    The Zuora rate plan ID used to apply the discount.
                </td>
            </tr>
            <tr>
                <th class="docs-monospace">discountId</th>
                <td>String</td>
                <td>
                    <span class="label">Braintree only</span>
                    The Braintree discount ID used to apply the discount.
                </td>
            </tr>
            <tr>
            	<th class="docs-monospace">referrerName</th>
            	<td>String</td>
            	<td>
            		The first and last name of the referrer that referred the user or null if no referrer exists.
            	</td>
            </tr>
        </table>
        

{% set req = '
$ curl https://app.referralsaasquatch.com/api/v1/{TENANT_ALIAS}/account/{ACCT_ID}}/reward \ <br>
-u API_KEY: \ <br>
-H "Content-Type: application/json" <br>
' %}
{% set res = '
{ <br>
    "accountId":"SV0TYE5OWI11120144", <br>
    "discountPercentage":10, <br>
    "referrerDiscountPercent":0, <br>
    "referredDiscountPercent":10, <br>
    "discountId":"saasquatch_discount" <br>
}' %}
{{ API.exampleCurl("get_account_reward", req, res) }}

    </div><!-- // .apidocs-section -->
        

<div class="apidocs-section">

<a id="create_webhook" name="create_webhook" class="section-anchor">&nbsp;</a>
<h2>Create a webhook subscription</h2>

<p>Subscribes a URL to receive events via webhooks</p>
<h4>Definition</h4>
<pre class="prettyprint lang-curl">POST https://app.referralsaasquatch.com/api/v1/{TENANT_ALIAS}/subscription</pre>

<h4>Arguments</h4>
<div>
    <table class="table table-hover apidocs-args">
      <tr>
        <th class="docs-monospace">endpointUrl</th>
        <td><span class="label">Required</span></td>
        <td>
            The url of the endpoint to receive events
        </td>
      </tr>
    </table>
</div>

<h4>Returns</h4>
<p>HTTP Created Status (Empty Response Body)</p>

{% set req = '
$ curl https://app.referralsaasquatch.com/api/v1/TENANT_ALIAS/subscription \ <br>
-u API_KEY: \ <br>
-H "Content-Type: application/json" \ <br>
-d "{"endpointUrl":"YOUR_ENDPOINT_URL"}" <br>
' %}
{% set res = '
Http Status 201 (No response body)
' %}
{{ API.exampleCurl("create_webhook", req, res) }}


</div>
  




<div class="apidocs-section">
<a id="delete_webhook" name="delete_webhook" class="section-anchor">&nbsp;</a>
<h2>Delete a webhook subscription</h2>

<p>Removes a URL from receiving events via webhooks</p>
<h4>Definition</h4>
<pre class="prettyprint lang-curl">DELETE https://app.referralsaasquatch.com/api/v1/{TENANT_ALIAS}/subscription/{URL}</pre>

<h4>Arguments</h4>
<div>
    <table class="table table-hover apidocs-args">
      <tr>
        <th class="docs-monospace">url</th>
        <td><span class="label">Required</span></td>
        <td>
            The url of the endpoint that will be removed. This must be URL-encoded before being passed to a 
        </td>
      </tr>
    </table>
</div>

<h4>Returns</h4>
<p>HTTP 204 - No response (Empty Response Body)</p>

{% set req = '
$ curl -X DELETE https://app.referralsaasquatch.com/api/v1/{TENANT_ALIAS}/subscription/{URL} \ <br>
-u API_KEY: \ <br>
-H "Content-Type: application/json" <br>
' %}
{% set res = '
HTTP 204 - No response (Empty Response Body)

' %}
{{ API.exampleCurl("delete_webhook", req, res) }}


</div>
  





<div class="apidocs-section">
<a id="list_webhooks" name="list_webhooks" class="section-anchor">&nbsp;</a>
<h2>List webhook subscriptions</h2>

<p>List all the URLs that are currently subscribed to receive events via webhooks</p>
<h4>Definition</h4>
<pre class="prettyprint lang-curl">GET https://app.referralsaasquatch.com/api/v1/{TENANT_ALIAS}/subscription</pre>

<h4>Arguments</h4>
<p>No arguments required.</p>

<h4>Returns</h4>
<p>A list of endpoints urls</p>

{% set req = '
$ curl https://app.referralsaasquatch.com/api/v1/TENANT_ALIAS/subscription \ <br>
-u API_KEY: \ <br>
-H "Content-Type: application/json" <br>
' %}
{% set res = '
[ <br>
    {"endpointUrl": "https://example.com/hook"}, <br>
    {"endpointUrl": "https://another.example.com/hook"}, <br>
    ... <br>
]
' %}
{{ API.exampleCurl("list_webhooks", req, res) }}

</div>


</section>

{% endblock content %}
